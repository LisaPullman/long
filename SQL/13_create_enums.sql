-- ============================================
-- PostgreSQL 枚举类型定义
-- PostgreSQL Enum Type Definitions
-- ============================================

-- 注意：PostgreSQL中枚举类型定义后不易修改
-- 建议使用VARCHAR替代枚举，以便灵活扩展
-- 本文件展示枚举类型的定义方式（可选实现）

-- ============================================
-- Mart 状态枚举
-- ============================================

-- CREATE TYPE mart_status AS ENUM (
--   'OPEN',        -- 进行中，可下单
--   'CLOSED',      -- 已截单，禁止下单
--   'ENDED'        -- 已结束
-- );

-- ============================================
-- 订单状态枚举
-- ============================================

-- CREATE TYPE order_status AS ENUM (
--   'CREATED',           -- 待处理
--   'PENDING_SHIPMENT',  -- 待发货
--   'SHIPPED',           -- 已发货
--   'DELIVERED',         -- 已送达
--   'COMPLETED',         -- 已完成
--   'CANCELED'           -- 已取消
-- );

-- ============================================
-- 预警状态枚举
-- ============================================

-- CREATE TYPE alert_status AS ENUM (
--   'ACTIVE',            -- 未处理
--   'RESOLVED'           -- 已处理
-- );

-- ============================================
-- 建议状态枚举
-- ============================================

-- CREATE TYPE suggestion_status AS ENUM (
--   'PENDING',           -- 待处理
--   'PROCESSED',         -- 已处理
--   'IGNORED'            -- 已忽略
-- );

-- ============================================
-- 消息类型枚举
-- ============================================

-- CREATE TYPE message_type AS ENUM (
--   'system',                -- 系统通知
--   'order',                 -- 订单通知
--   'shipping',              -- 配送通知
--   'inventory_alert',       -- 库存提醒 ⭐ 新增
--   'promotion'              -- 营销推广
-- );

-- ============================================
-- 地区级别枚举
-- ============================================

-- CREATE TYPE region_level AS ENUM (
--   'province',              -- 省级
--   'city',                  -- 城市
--   'district'               -- 区县
-- );

-- ============================================
-- 评论类型枚举
-- ============================================

-- CREATE TYPE review_type AS ENUM (
--   'goods',                 -- 商品评论
--   'shop'                   -- 店铺评论
-- );

-- ============================================
-- 实际使用建议
-- ============================================

-- 推荐方案：VARCHAR + CHECK约束
-- 好处：
-- 1. 灵活性强，可后期快速添加新状态
-- 2. 易于扩展，无需修改表结构
-- 3. 便于迁移，VARCHAR更通用
-- 
-- 示例：
-- CREATE TABLE orders (
--   status VARCHAR(30) DEFAULT 'CREATED',
--   CHECK (status IN ('CREATED', 'PENDING_SHIPMENT', 'SHIPPED', 'DELIVERED', 'COMPLETED', 'CANCELED'))
-- );

-- ============================================
-- 如果使用枚举类型，表定义修改为：
-- ============================================

-- 不使用 ENUM，而是 VARCHAR 方案已在各表文件中应用
-- 保证数据库设计的灵活性和可维护性

-- ============================================
-- 业务数据字典
-- Business Data Dictionary
-- ============================================

-- Mart 状态流转：OPEN → CLOSED (自动或手动) → ENDED

-- 订单状态流转跟Mart配送：
--   CREATED
--     ↓
--   PENDING_SHIPMENT (Mart截单后自动)
--     ↓
--   SHIPPED (发起者发货)
--     ↓
--   DELIVERED (配送完成)
--     ↓
--   COMPLETED (用户确认或自动确认)
--   
--   可随时: →取消→ CANCELED

-- 预警状态：ACTIVE → RESOLVED (店主标记)

-- 建议状态：PENDING → PROCESSED/IGNORED (管理员处理)

-- 消息类型用途：
--   system: 系统消息
--   order: 订单状态变更（下单、截单、发货等）
--   shipping: 配送更新
--   inventory_alert: 库存预警 ⭐ 新增类型
--   promotion: 营销通知

-- 评论状态流转：
--   is_approved = false (初始)
--     ↓
--   is_approved = true + approved_at (店主审批后公显)

-- ============================================
-- 配置参数示例
-- ============================================

-- 预计发货天数默认值：3天
-- 自动确认收货天数默认值：7天
-- 最小订单金额：40元
-- 免运费门槛：60元
-- 运费：40-60元的订单收取运费

-- 库存预警阈值：由店主自定义，建议5-20件
-- 商品限购数量：由店主自定义，无上限
-- 评分范围：1-5星

-- ============================================
-- 扩展性考虑
-- ============================================

-- 如需添加新状态，只需Update CHECK约束或业务逻辑
-- 无需修改数据库Schema

-- 示例：添加新消息类型 'refund_alert'
-- 只需要在应用层代码中添加新类型处理
-- 数据库不需要任何修改
